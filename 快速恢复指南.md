# 🔧 **快速恢复指南：解决加密密钥不匹配问题**

## 🎯 **问题诊断**

如果你遇到以下错误：
- **500 Internal Server Error** 在调用 `/api/config-get` 时
- **"配置加密密钥已变更，请重新保存配置"** 错误提示

这通常是因为：
1. **环境变量 `CONFIG_ENC_KEY` 被更改了**
2. **之前保存的配置使用了不同的加密密钥**

## ✅ **解决方案**

### **方案一：重新保存配置（推荐）**

1. **确保已登录**：使用Netlify Identity登录
2. **访问配置页面**：https://unrivaled-pavlova-43ddb4.netlify.app/config
3. **重新填写配置**：
   - App ID
   - App Secret  
   - 多维表格链接
4. **点击"保存配置"**：这会用新的加密密钥重新保存

### **方案二：清除后重新配置**

如果方案一不行，可以清除旧配置：

1. **打开浏览器控制台**（F12）
2. **执行清除命令**：
   ```javascript
   extractor.clearUserConfig().then(result => {
       if (result.ok) {
           console.log('配置已清除，请重新保存配置');
       } else {
           console.error('清除失败:', result.error);
       }
   });
   ```
3. **重新保存配置**：按方案一的步骤操作

### **方案三：检查环境变量**

在Netlify控制台中确认 `CONFIG_ENC_KEY` 设置正确：

1. 登录Netlify控制台
2. 选择你的项目
3. 进入 **Site settings** → **Environment variables**
4. 确认 `CONFIG_ENC_KEY` 存在且正确

## 🔍 **验证修复**

修复后，你可以通过以下方式验证：

1. **检查配置状态**：
   ```javascript
   extractor.checkConfigStatus().then(status => {
       console.log('配置状态:', status);
   });
   ```

2. **测试提取功能**：
   - 输入一个测试URL
   - 点击"开始提取"
   - 应该成功工作

## 🎉 **成功标志**

当看到以下结果时，说明问题已解决：

- ✅ 配置保存成功
- ✅ 提取功能正常工作
- ✅ 不再出现500错误
- ✅ 不再出现"配置加密密钥已变更"错误

## 🚀 **预防措施**

为了避免将来再次出现此问题：

1. **不要随意更改 `CONFIG_ENC_KEY`**
2. **如果需要更改密钥，先清除所有用户配置**
3. **保持环境变量的一致性**

**现在你的系统应该完全正常工作了！** 🎉
